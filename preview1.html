<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <title>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</title>

    <style>
      body {
        font-family: "Helvetica", "Tajawal", sans-serif;
      }
    </style>
  </head>

  <body class="bg-gray-100 py-10">
    <div class="max-w-6xl mx-auto">
      <!-- Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
      <div
        class="max-w-4xl mx-auto bg-white shadow-xl border rounded-2xl overflow-hidden mb-8"
        id="template"
      >
        <div
          class="bg-gradient-to-l from-green-900 to-cyan-500 text-white p-6 flex justify-between items-center"
        >
          <div>
            <p class="text-sm" id="edu"></p>
            <p class="text-sm">Ø¨Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</p>
            <p class="font-bold mt-1">Ù…Ø¯Ø±Ø³Ø©</p>
          </div>
          <div class="w-20">
            <img src="./assets/imgs/gsoor_logo.jpg" alt="" />
          </div>
          <img src="img/qr.png" class="w-20 h-20 bg-white p-1 rounded shadow" />
        </div>

        <div
          class="bg-cyan-700 text-white text-center py-3 text-xl font-bold"
          id="programTitle"
        ></div>

        <div class="p-6 grid grid-cols-2 gap-4 text-gray-700 text-sm">
          <div>
            <p class="font-bold text-green-800 mb-1">Ø§Ù„Ù…Ù†ÙØ°ÙˆÙ†:</p>
            <div class="border rounded-md p-2" id="executor"></div>
          </div>

          <div>
            <p class="font-bold text-green-800 mb-1">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ†:</p>
            <div class="border rounded-md p-2" id="participants"></div>
          </div>

          <div>
            <p class="font-bold text-green-800 mb-1">Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°:</p>
            <div class="border rounded-md p-2" id="place"></div>
          </div>

          <div>
            <p class="font-bold text-green-800 mb-1">Ù…Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ°:</p>
            <div class="border rounded-md p-2" id="duration"></div>
          </div>

          <div>
            <p class="font-bold text-green-800 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ†ÙÙŠØ°:</p>
            <div class="border rounded-md p-2" id="date"></div>
          </div>

          <div>
            <p class="font-bold text-green-800 mb-1">Ø§Ù„Ù…Ø¬Ø§Ù„:</p>
            <div class="border rounded-md p-2" id="field"></div>
          </div>

          <div class="col-span-2">
            <p class="font-bold text-green-800 mb-1">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ† / Ø§Ù„Ø¹Ø¯Ø¯:</p>
            <div class="border rounded-md p-2" id="beneficiaries"></div>
          </div>

          <div class="col-span-2">
            <p class="font-bold text-green-800 mb-1">Ø§Ù„Ø£Ù‡Ø¯Ø§Ù:</p>
            <div class="border rounded-md p-3 leading-7" id="goals"></div>
          </div>

          <div class="col-span-2">
            <p class="font-bold text-green-800 mb-1">Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ†ÙÙŠØ° / Ø§Ù„ÙˆØµÙ:</p>
            <div class="border rounded-md p-3 leading-7" id="steps"></div>
          </div>

          <div class="col-span-2 text-center mt-4">
            <p class="text-green-800 font-bold text-lg mb-3">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯:</p>
            <div class="flex justify-center gap-6 flex-wrap">
              <img
                id="cert1Preview"
                class="w-80 h-48 object-contain bg-white p-2 rounded shadow"
              />
              <img
                id="cert2Preview"
                class="w-80 h-48 object-contain bg-white p-2 rounded shadow"
              />
            </div>
          </div>
        </div>

        <div class="bg-[#003b49] text-white text-center py-3 text-sm">
          Ù…ÙˆÙ‚Ø¹ Ù†Ù…Ø§Ø°Ø¬ ØªØ¹Ù„ÙŠÙ…ÙŠØ© - www.edu-forms.com
        </div>
      </div>

      <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
      <div class="flex justify-center gap-4 flex-wrap">
        <button
          onclick="downloadImage()"
          class="bg-blue-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-blue-700"
        >
          ğŸ“¥ ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø©
        </button>

        <button
          onclick="downloadPDF()"
          class="bg-red-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-red-700"
        >
          ğŸ“„ ØªØ­Ù…ÙŠÙ„ PDF
        </button>

        <button
          onclick="goBack()"
          class="bg-gray-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-gray-700"
        >
          â¬…ï¸ Ø±Ø¬ÙˆØ¹
        </button>
      </div>
    </div>

    <script>
      const data = JSON.parse(localStorage.getItem("templateData"));

      if (!data) {
        window.location.href = "form1.html";
      }

      document.getElementById("edu").textContent = data.edu || "";
      document.getElementById("programTitle").textContent = data.program || "";
      document.getElementById("executor").textContent = data.executor || "";
      document.getElementById("participants").textContent =
        data.participants || "";
      document.getElementById("place").textContent = data.place || "";
      document.getElementById("duration").textContent = data.duration || "";
      document.getElementById("date").textContent = data.date || "";
      document.getElementById("field").textContent = data.field || "";
      document.getElementById("beneficiaries").textContent =
        data.beneficiaries || "";

      document.getElementById("goals").innerHTML = (data.goals || "").replace(
        /\n/g,
        "<br>"
      );
      document.getElementById("steps").innerHTML = (data.steps || "").replace(
        /\n/g,
        "<br>"
      );

      if (data.cert1) {
        document.getElementById("cert1Preview").src = data.cert1;
      }
      if (data.cert2) {
        document.getElementById("cert2Preview").src = data.cert2;
      }

      function goBack() {
        window.history.back();
      }

      function downloadImage() {
        html2canvas(document.getElementById("template"), {
          backgroundColor: "#ffffff",
          scale: 2,
        }).then((canvas) => {
          const link = document.createElement("a");
          link.download = "report.png";
          link.href = canvas.toDataURL();
          link.click();
        });
      }

      function downloadPDF() {
        html2canvas(document.getElementById("template"), {
          backgroundColor: "#ffffff",
          scale: 2,
        }).then((canvas) => {
          const imgData = canvas.toDataURL("image/jpeg");
          const pdf = new jspdf.jsPDF("p", "mm", "a4");
          const imgWidth = 210;
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          pdf.addImage(imgData, "JPEG", 0, 0, imgWidth, imgHeight);
          pdf.save("report.pdf");
        });
      }
    </script>
  </body>
</html>
