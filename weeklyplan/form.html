<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
  <!-- Add this to your head section -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">

<style>
    body {
        font-family: Tahoma, sans-serif;
        background: #f4f4f4;
        margin: 0;
        direction: rtl;
    }

    .container {
        width: 90%;
        margin: 20px auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px #ccc;
    }

    h2 {
        text-align: center;
        margin-bottom: 10px;
    }
    
.footer-ink {
        background: #f8fafb;
      }

      .social-icon {
        width: 26px;
        height: 26px;
        fill: currentColor;
      }



    .row {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
    }

    .col {
        flex: 1;
    }

    label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
        font-size: 14px;
    }

    input, select, textarea {
        width: 100%;
        padding: 8px;
        font-size: 15px;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box;
    }

    textarea {
        height: 80px;
    }

    .day-box {
        background: #f8f8f8;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
        border: 1px solid #ddd;
    }

    .day-header {
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        padding: 8px;
        background: #e9e9e9;
        border-radius: 8px;
        margin-bottom: 10px;
    }

    .buttons {
        text-align: center;
        margin-top: 20px;
    }

    button {
        padding: 12px 20px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin: 5px;
    }

    .save-btn {
        background: #00b33c;
        color: white;
    }

    .pdf-btn {
        background: #0066cc;
        color: white;
    }

    .btn-main {
        background: #10b981;
        color: white;
        font-weight: bold;
    }

    /* Modal Styles */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        overflow-y: auto;
        padding: 20px;
    }

    .modal-overlay.active {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .modal-content {
        background: white;
        border-radius: 16px;
        max-width: 90%;
        width: 100%;
        max-width: 1200px;
        position: relative;
        margin: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid #e5e7eb;
    }

    .modal-body {
        padding: 20px;
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .modal-close {
        background: none;
        border: none;
        font-size: 28px;
        cursor: pointer;
        color: #6b7280;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.2s;
    }

    .modal-close:hover {
        background-color: #f3f4f6;
        color: #111827;
    }

    .preview-template {
        background: white;
        padding: 40px;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
    }

    /* Error Message Styles */
    .error-message {
        color: #dc2626;
        font-size: 14px;
        margin-top: 4px;
        display: none;
    }

    .error-message.show {
        display: block;
    }

    .field-error {
        border-color: #dc2626 !important;
        border-width: 2px !important;
    }

    .field-error:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
    }
</style>
</head>

<body>

<div class="container">

    <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</h2>
    <p style="text-align:center;">Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„ â€” Ù…Ù† 1447/03/01 Ø¥Ù„Ù‰ 1447/03/05</p>

    <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù… -->
    <div class="row">
        <div class="col">
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</label>
            <input type="text" id="teacherName">
            <div id="teacherNameError" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
        </div>
        <div class="col">
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</label>
            <input type="text" id="schoolName">
            <div id="schoolNameError" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
        </div>
    </div>

    <div class="row">
        <div class="col">
            <label>Ø§Ù„Ù…Ø§Ø¯Ø©</label>
            <input type="text" id="subject">
            <div id="subjectError" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
        </div>
        <div class="col">
            <label>Ø§Ù„ØµÙ</label>
            <select id="grade">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                <option>Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„</option>
                <option>Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                <option>Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«</option>
            </select>
            <div id="gradeError" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
        </div>
    </div>

    <!-- Ø§Ù„Ø£ÙŠØ§Ù… -->
    <div id="days"></div>

    <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
    <div class="buttons">
        <button class="save-btn" onclick="saveData()">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="btn-main" onclick="previewReport()">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
        <button class="pdf-btn" onclick="generatePDF()">ğŸ“„ ØªØ­Ù…ÙŠÙ„ PDF</button>
    </div>

</div>

<!-- Modal Popup Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
<div id="previewModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="text-2xl font-bold text-gray-800">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h2>
            <button class="modal-close" onclick="closePreviewModal()">
                &times;
            </button>
        </div>
        <div class="modal-body">
            <div id="previewTemplateContent" class="preview-template">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            <div class="flex justify-center gap-4 mt-6">
                <button
                    onclick="downloadImageFromModal()"
                    class="bg-blue-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-700 transition flex items-center gap-2"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="2"
                        stroke="currentColor"
                        class="w-5 h-5"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"
                        />
                    </svg>
                    ØªØ­Ù…ÙŠÙ„ ÙƒØµÙˆØ±Ø©
                </button>
                <button
                    onclick="downloadPDFFromModal()"
                    class="bg-red-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-red-700 transition flex items-center gap-2"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="2"
                        stroke="currentColor"
                        class="w-5 h-5"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"
                        />
                    </svg>
                    ØªØ­Ù…ÙŠÙ„ PDF
                </button>
                <button
                    onclick="closePreviewModal()"
                    class="bg-gray-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-gray-700 transition"
                >
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
        </div>
    </div>
</div>

<!-- FOOTER -->
    <footer class="mt-12 footer-ink border-t border-gray-100">
      <div
        class="max-w-6xl mx-auto px-6 py-8 flex flex-col md:flex-row md:items-center md:justify-between gap-6"
      >
        <!-- RIGHT COLUMN -->
        <div class="text-right md:flex-1">
          <img
            src="../assets/imgs/gsoor_logo.jpg"
            alt="logo"
            class="h-10 mx-auto md:mx-0"
          />
          <div
            class="flex justify-center md:justify-end gap-4 mt-3 text-gray-600"
          >
            <i class="fa-brands fa-youtube social-icon text-lg"></i>
            <i class="fa-brands fa-tiktok social-icon text-lg"></i>
            <i class="fa-brands fa-instagram social-icon text-lg"></i>
          </div>
        </div>

        <!-- CENTER COLUMN -->
        <div class="text-center md:flex-1">
          <h3 class="font-bold mb-2">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
          <div class="flex items-center justify-center gap-4 text-gray-600">
            <div class="flex items-center gap-2">
              <i class="fa-regular fa-envelope text-sm"></i>
              <span>Ø§Ù„Ø¨Ø±ÙŠØ¯</span>
            </div>
            <div class="flex items-center gap-2">
              <i class="fa-solid fa-mobile-screen-button text-sm"></i>
              <span>ÙˆØ§ØªØ³</span>
            </div>
          </div>
          <div class="mt-3 text-sm text-gray-500">Ù…ÙˆÙ‚Ù‘Ø¹ Ù„Ø¯Ù‰ Ù…Ù†ØµØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</div>
        </div>

        <!-- LEFT COLUMN -->
        <div class="text-left md:flex-1">
          <div class="text-sm text-gray-500">
            Â© 2025 Ù…ØªØ¬Ø± Ø¬Ø³ÙˆØ± Ø§Ù„Ø±Ù‚Ù…ÙŠ | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
          </div>
          <div
            class="mt-3 flex gap-2 items-center justify-center md:justify-start"
          >
            <span class="sr-only">Visa</span>
            <i class="fa-brands fa-cc-visa text-gray-600 text-lg"></i>
            <span class="sr-only">Mada</span>
            <i class="fa-solid fa-credit-card text-gray-600 text-lg"></i>
          </div>
        </div>
      </div>
    </footer>
<script>
    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø£ÙŠØ§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
    const days = ["Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"];
    const container = document.getElementById("days");

    days.forEach((day, index) => {
        container.innerHTML += `
            <div class="day-box">
                <div class="day-header" onclick="toggleDay(${index})">
                    ${day} - ${1447}/03/${1 + index} 
                </div>
                <div id="day-content-${index}" style="display: none;">
                    
                    <label>Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø¯Ø±Ø³</label>
                    <input type="text" id="topic-${index}">
                    <div id="topic-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>

                    <label>Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³</label>
                    <textarea id="goals-${index}" placeholder="Ø§Ù„Ø£Ù‡Ø¯Ø§Ù"></textarea>
                    <div id="goals-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>

                    <label>Ø§Ù„ÙˆØ§Ø¬Ø¨ ÙˆØ§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©:</label>
                    <textarea id="homework-${index}" placeholder="Ø¹Ù„Ù‰ Ù…Ù†ØµØ© Ù…Ø¯Ø±Ø³ØªÙŠ"></textarea>
                    <div id="homework-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>

                    <h3 style="margin-top: 15px; font-size: 16px;">ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ° Ø§Ù„Ø¯Ø±Ø³</h3>

                    <div class="row">
                        <div class="col">
                            <label>Ø­Ø§Ù„Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø¯Ø±Ø³:</label>
                            <select id="executionStatus-${index}">
                                <option>ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° ÙƒØ§Ù…Ù„Ø§Ù‹</option>
                                <option>ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³</option>
                                <option>Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                            </select>
                        </div>
                        <div class="col">
                            <label>ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³:</label>
                            <select id="goalsAchieved-${index}">
                                <option>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ØªØ­Ù‚Ù‚Øª</option>
                                <option>Ù…Ø¹Ø¸Ù… Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ØªØ­Ù‚Ù‚Øª</option>
                                <option>Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ØªØ­Ù‚Ù‚Øª</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙÙ‡Ù…:</label>
                            <select id="understandingLevel-${index}">
                                <option>Ø¹Ø§Ù„ÙŠ (80-100%)</option>
                                <option>Ù…ØªÙˆØ³Ø· (60-79%)</option>
                                <option>Ù…Ù†Ø®ÙØ¶ (Ø£Ù‚Ù„ Ù…Ù† 60%)</option>
                            </select>
                        </div>
                        <div class="col">
                            <label>Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§Ù„ØªÙØ§Ø¹Ù„:</label>
                            <select id="interactionLevel-${index}">
                                <option>Ø¹Ø§Ù„ÙŠØ© (80-100%)</option>
                                <option>Ù…ØªÙˆØ³Ø·Ø© (60-79%)</option>
                                <option>Ù…Ù†Ø®ÙØ¶Ø© (Ø£Ù‚Ù„ Ù…Ù† 60%)</option>
                            </select>
                        </div>
                    </div>

                    <label>Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:</label>
                    <input type="text" id="tools-${index}" value="Ø§Ù„ÙƒØªØ§Ø¨ØŒ Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©ØŒ Ø£ÙˆØ±Ø§Ù‚ Ø¹Ù…Ù„">
                    <div id="tools-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>

                    <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ³ Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©:</label>
                    <input type="text" id="strategies-${index}" value="Ø§Ù„ØªØ¯Ø±ÙŠØ³ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±ØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ø§ÙƒØªØ´Ø§Ù">
                    <div id="strategies-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
                    
                    <label>Ø§Ù„ØµØ¹ÙˆØ¨Ø§Øª ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ§Øª:</label>
                    <input type="text" id="challenges-${index}" placeholder="Ø§Ø®ØªØ± Ø§Ù„ØµØ¹ÙˆØ¨Ø§Øª ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ§Øª">
                    <div id="challenges-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>

                    <label>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ© (Ø§Ù„ØªØ¯Ø®Ù„Ø§Øª Ø§Ù„Ø¯Ø§Ø¹Ù…Ø©):</label>
                    <input type="text" id="interventions-${index}" value="Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù…Ø«Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ©ØŒ Ø§Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØŒ ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©">
                    <div id="interventions-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
                    
                    <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø³:</label>
                    <textarea id="notes-${index}" placeholder="Ù‚Ù… Ø¨Ø­Ù„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø© Ù„Ø±ÙØ¹ Ø¯Ø±Ø¬Ø§Øª ØªØ­ØµÙŠÙ„Ùƒ"></textarea>
                    <div id="notes-${index}Error" class="error-message">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
                </div>
            </div>
        `;
    });

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙŠÙˆÙ…
    function toggleDay(i) {
        const box = document.getElementById("day-content-" + i);
        box.style.display = box.style.display === "none" ? "block" : "none";
    }

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function validateForm() {
        let isValid = true;

        // Ø¥Ø²Ø§Ù„Ø© Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
        document.querySelectorAll(".error-message").forEach((error) => {
            error.classList.remove("show");
        });
        document.querySelectorAll(".field-error").forEach((field) => {
            field.classList.remove("field-error");
        });

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        const requiredFields = [
            'teacherName', 'schoolName', 'subject', 'grade'
        ];

        requiredFields.forEach(fieldId => {
            const field = document.getElementById(fieldId);
            if (!field.value.trim()) {
                showError(fieldId, `${fieldId}Error`);
                isValid = false;
            }
        });

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£ÙŠØ§Ù…
        for (let i = 0; i < 5; i++) {
            const dayFields = [
                `topic-${i}`, `goals-${i}`, `homework-${i}`, 
                `tools-${i}`, `strategies-${i}`, `challenges-${i}`,
                `interventions-${i}`, `notes-${i}`
            ];

            dayFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && !field.value.trim()) {
                    showError(fieldId, `${fieldId}Error`);
                    isValid = false;
                }
            });
        }

        return isValid;
    }

    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
    function showError(fieldId, errorId) {
        const field = document.getElementById(fieldId);
        const error = document.getElementById(errorId);
        if (field) {
            field.classList.add("field-error");
        }
        if (error) {
            error.classList.add("show");
        }
    }

    // Ø¥Ø²Ø§Ù„Ø© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø©
    function setupFieldValidation() {
        const textFields = [
            'teacherName', 'schoolName', 'subject'
        ];

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        textFields.forEach((fieldId) => {
            const field = document.getElementById(fieldId);
            if (field) {
                field.addEventListener("input", function () {
                    this.classList.remove("field-error");
                    const error = document.getElementById(`${fieldId}Error`);
                    if (error) {
                        error.classList.remove("show");
                    }
                });
            }
        });

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ù‚Ù„ Ø§Ù„ØµÙ
        const gradeField = document.getElementById('grade');
        if (gradeField) {
            gradeField.addEventListener("change", function () {
                this.classList.remove("field-error");
                const error = document.getElementById('gradeError');
                if (error) {
                    error.classList.remove("show");
                }
            });
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£ÙŠØ§Ù…
        for (let i = 0; i < 5; i++) {
            const dayFields = [
                `topic-${i}`, `goals-${i}`, `homework-${i}`, 
                `tools-${i}`, `strategies-${i}`, `challenges-${i}`,
                `interventions-${i}`, `notes-${i}`
            ];

            dayFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener("input", function () {
                        this.classList.remove("field-error");
                        const error = document.getElementById(`${fieldId}Error`);
                        if (error) {
                            error.classList.remove("show");
                        }
                    });
                }
            });
        }
    }

    // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    document.addEventListener('DOMContentLoaded', function() {
        setupFieldValidation();
        loadSavedData();
    });

    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function saveData() {
        if (!validateForm()) {
            const firstError = document.querySelector(".field-error");
            if (firstError) {
                firstError.scrollIntoView({ behavior: "smooth", block: "center" });
            }
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©");
            return;
        }

        let data = {
            teacher: document.getElementById("teacherName").value,
            school: document.getElementById("schoolName").value,
            subject: document.getElementById("subject").value,
            grade: document.getElementById("grade").value,
            days: []
        };

        for (let i = 0; i < 5; i++) {
            data.days.push({
                topic: document.getElementById(`topic-${i}`).value,
                goals: document.getElementById(`goals-${i}`).value,
                homework: document.getElementById(`homework-${i}`).value,
                executionStatus: document.getElementById(`executionStatus-${i}`).value,
                goalsAchieved: document.getElementById(`goalsAchieved-${i}`).value,
                understandingLevel: document.getElementById(`understandingLevel-${i}`).value,
                interactionLevel: document.getElementById(`interactionLevel-${i}`).value,
                tools: document.getElementById(`tools-${i}`).value,
                strategies: document.getElementById(`strategies-${i}`).value,
                challenges: document.getElementById(`challenges-${i}`).value,
                interventions: document.getElementById(`interventions-${i}`).value,
                notes: document.getElementById(`notes-${i}`).value
            });
        }

        localStorage.setItem("reportForm", JSON.stringify(data));
        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ”");
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
    function loadSavedData() {
        const savedData = localStorage.getItem("reportForm");
        if (savedData) {
            const data = JSON.parse(savedData);
            
            document.getElementById("teacherName").value = data.teacher || "";
            document.getElementById("schoolName").value = data.school || "";
            document.getElementById("subject").value = data.subject || "";
            document.getElementById("grade").value = data.grade || "";

            if (data.days) {
                for (let i = 0; i < data.days.length; i++) {
                    const day = data.days[i];
                    document.getElementById(`topic-${i}`).value = day.topic || "";
                    document.getElementById(`goals-${i}`).value = day.goals || "";
                    document.getElementById(`homework-${i}`).value = day.homework || "";
                    document.getElementById(`executionStatus-${i}`).value = day.executionStatus || "ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° ÙƒØ§Ù…Ù„Ø§Ù‹";
                    document.getElementById(`goalsAchieved-${i}`).value = day.goalsAchieved || "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ØªØ­Ù‚Ù‚Øª";
                    document.getElementById(`understandingLevel-${i}`).value = day.understandingLevel || "Ø¹Ø§Ù„ÙŠ (80-100%)";
                    document.getElementById(`interactionLevel-${i}`).value = day.interactionLevel || "Ø¹Ø§Ù„ÙŠØ© (80-100%)";
                    document.getElementById(`tools-${i}`).value = day.tools || "Ø§Ù„ÙƒØªØ§Ø¨ØŒ Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©ØŒ Ø£ÙˆØ±Ø§Ù‚ Ø¹Ù…Ù„";
                    document.getElementById(`strategies-${i}`).value = day.strategies || "Ø§Ù„ØªØ¯Ø±ÙŠØ³ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±ØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØŒ Ø§Ù„ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ø§ÙƒØªØ´Ø§Ù";
                    document.getElementById(`challenges-${i}`).value = day.challenges || "";
                    document.getElementById(`interventions-${i}`).value = day.interventions || "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù…Ø«Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ©ØŒ Ø§Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØŒ ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©";
                    document.getElementById(`notes-${i}`).value = day.notes || "";
                }
            }
        }
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
    function previewReport() {
        if (!validateForm()) {
            const firstError = document.querySelector(".field-error");
            if (firstError) {
                firstError.scrollIntoView({ behavior: "smooth", block: "center" });
            }
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©");
            return;
        }

        saveData(); // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        generatePreviewContent();
        openPreviewModal();
    }

    // ÙØªØ­ Ø§Ù„Ù€ modal
    function openPreviewModal() {
        const modal = document.getElementById("previewModal");
        modal.classList.add("active");
        document.body.style.overflow = "hidden";
    }

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù€ modal
    function closePreviewModal() {
        const modal = document.getElementById("previewModal");
        modal.classList.remove("active");
        document.body.style.overflow = "auto";
    }

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù€ modal Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    document.getElementById("previewModal")?.addEventListener("click", function (e) {
        if (e.target === this) {
            closePreviewModal();
        }
    });

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù€ modal Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ESC
    document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
            closePreviewModal();
        }
    });

    // ØªÙˆÙ„ÙŠØ¯ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
    function generatePreviewContent() {
        const data = JSON.parse(localStorage.getItem("reportForm") || "{}");
        const previewContainer = document.getElementById("previewTemplateContent");

        let daysHTML = '';
        if (data.days) {
            data.days.forEach((day, index) => {
                daysHTML += `
                    <div class="day-box" style="margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
                        <h3 style="color: #10b981; margin-bottom: 10px;">${days[index]} - ${1447}/03/${1 + index}</h3>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø¯Ø±Ø³:</strong> ${day.topic || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³:</strong><br>
                                ${day.goals || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø§Ù„ÙˆØ§Ø¬Ø¨ ÙˆØ§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©:</strong><br>
                                ${day.homework || ''}
                            </div>
                        </div>
                        
                        <h4 style="margin-top: 15px; color: #374151;">ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ° Ø§Ù„Ø¯Ø±Ø³:</h4>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø­Ø§Ù„Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø¯Ø±Ø³:</strong> ${day.executionStatus || ''}
                            </div>
                            <div class="col">
                                <strong>ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³:</strong> ${day.goalsAchieved || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙÙ‡Ù…:</strong> ${day.understandingLevel || ''}
                            </div>
                            <div class="col">
                                <strong>Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§Ù„ØªÙØ§Ø¹Ù„:</strong> ${day.interactionLevel || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:</strong> ${day.tools || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ³:</strong> ${day.strategies || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø§Ù„ØµØ¹ÙˆØ¨Ø§Øª ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ§Øª:</strong> ${day.challenges || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©:</strong> ${day.interventions || ''}
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø³:</strong><br>
                                ${day.notes || ''}
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        let html = `
            <div class="space-y-6">
                <div style="text-align: center; margin-bottom: 30px;">
                    <h1 style="font-size: 28px; color: #10b981; margin-bottom: 10px;">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h1>
                    <p style="font-size: 16px; color: #6b7280;">Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„ â€” Ù…Ù† 1447/03/01 Ø¥Ù„Ù‰ 1447/03/05</p>
                </div>

                <div class="row" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <div class="col">
                        <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…:</strong> ${data.teacher || ''}
                    </div>
                    <div class="col">
                        <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©:</strong> ${data.school || ''}
                    </div>
                </div>

                <div class="row" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <div class="col">
                        <strong>Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> ${data.subject || ''}
                    </div>
                    <div class="col">
                        <strong>Ø§Ù„ØµÙ:</strong> ${data.grade || ''}
                    </div>
                </div>

                ${daysHTML}
            </div>
        `;

        previewContainer.innerHTML = html;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ù€ modal
    function downloadImageFromModal() {
        const previewContent = document.getElementById("previewTemplateContent");
        html2canvas(previewContent, {
            backgroundColor: "#ffffff",
            scale: 2,
        }).then((canvas) => {
            const link = document.createElement("a");
            link.download = "weekly-report.png";
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    // ØªØ­Ù…ÙŠÙ„ PDF Ù…Ù† Ø§Ù„Ù€ modal
    function downloadPDFFromModal() {
        const previewContent = document.getElementById("previewTemplateContent");
        html2canvas(previewContent, {
            backgroundColor: "#ffffff",
            scale: 2,
        }).then((canvas) => {
            const imgData = canvas.toDataURL("image/jpeg");
            const pdf = new jspdf.jsPDF("p", "mm", "a4");
            const imgWidth = 210;
            const imgHeight = (canvas.height * imgWidth) / canvas.width;
            pdf.addImage(imgData, "JPEG", 0, 0, imgWidth, imgHeight);
            pdf.save("weekly-report.pdf");
        });
    }

    // ØªÙˆÙ„ÙŠØ¯ PDF â€” Ø¨Ø³ÙŠØ· (Ù†Ù‚Ø¯Ø± Ø£Ø¹Ù…Ù„Ù‡ Ù…Ø­ØªØ±Ù Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… html2canvas + jsPDF)
    function generatePDF() {
        if (!validateForm()) {
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„");
            return;
        }
        saveData();
        downloadPDFFromModal();
    }
</script>

</body>
</html>
